<div class="mobileShow red mobile-home">
  <div class="title">
    <%= link_to root_path do %><h1>ESTHER ET SELMA</h1><% end %>
    <p>Rencontres cinématographiques<br>
    15—18 novembre 2023, Essaouira</p>
  </div>
  <%= image_tag 'E&S-logo-white.svg', style:"height:21rem;"%>
  <div class="menu-mobile">
    <ul>
      <li><%= link_to "Un festival engagé", festival_path %></li>
      <li><%= link_to "2023, édition pionnière", edition2023_path %></li>
      <li><%= link_to "Paroles", paroles_path %></li>
      <li><%= link_to "Tissu culturel", tissu_culturel_path %></li>
      <li><%= link_to "Programme", programme15_path %></li>
      <li><%= link_to "Infos pratiques", infos_pratiques_path %></li>
      <li><%= link_to "Billetterie", billeterie_path %></li>
      <li><%= link_to "Contact", contact_path %></li>
    </ul>
  </div>
</div>
<div id="fullscreen-svg" class="fullscreen-svg mobileHide"></div>
<div class="center-video mobileHide">
  <div id="video-carousel" class="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <video id="video1" class="carousel-video" muted>
          <source src="<%= asset_path 'video1.mp4' %>" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
      <!-- Similar changes for other videos -->
      <div class="carousel-item">
        <video id="video2" class="carousel-video" muted>
          <source src="<%= asset_path 'video2.mp4' %>" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
      <div class="carousel-item">
        <video id="video3" class="carousel-video" muted>
          <source src="<%= asset_path 'video3.mp4' %>" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
      <div class="carousel-item">
        <video id="video4" class="carousel-video" muted>
          <source src="<%= asset_path 'video4.mp4' %>" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
    </div>
  </div>
</div>
<div class="right-side mobileHide">
  <div class="news">
    <p id="next-video" style=" position: fixed; bottom: 4.8rem; right: 1.5rem; cursor: pointer;">EXTRAIT SUIVANT</p>
    <p id="toggle-sound" style=" position: fixed; bottom: 3.7rem; right: 1.5rem; cursor: pointer;">ACTIVER LE SON
    </p>
    <h5>Dernières actualités</h5>
    <table>
      <tr style="padding-bottom: 1rem">
        <td class="news-date">12/08</td>
        <td style="padding-left: 1rem">Fusce eget elit vel purus lobortis commodo. In at tortor risus. Curabitur et fringilla lacus.</td>
      </tr>
      <tr>
        <td class="news-date">10/08</td>
        <td style="padding-left: 1rem">Le programme complet est disponible en téléchargement dès aujourd’hui !</td>
      </tr>
    </table>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const carouselItems = document.querySelectorAll('.carousel-item');
    const videos = document.querySelectorAll('.carousel-video');
    let currentIndex = 0;

    //Code pour activer le son
    let isMuted = true; // initial state

    document.getElementById('toggle-sound').addEventListener('click', function() {
      isMuted = !isMuted; // toggle the global sound state

      videos.forEach(video => {
        video.muted = isMuted;
      });

      this.innerText = isMuted ? "ACTIVER LE SON" : "DÉSACTIVER LE SON";
    });


    function showVideo(index) {
      if (index < 0) {
          index = carouselItems.length - 1;
      } else if (index >= carouselItems.length) {
          index = 0;
      }

      carouselItems[currentIndex].classList.remove('active'); // Remove active from the current item
      videos[currentIndex].pause(); // Pause the current video
      videos[currentIndex].currentTime = 0; // Reset the current video time

      currentIndex = index;

      carouselItems[currentIndex].classList.add('active'); // Add active to the new item
      videos[currentIndex].muted = isMuted; // Set the sound state for the new video based on global state
      videos[currentIndex].setAttribute('controls', 'true'); // Add controls to the new active video
      videos[currentIndex].play(); // Play the new active video
    }


    document.getElementById('next-video').addEventListener('click', function() {
      showVideo(currentIndex + 1);
    });

    // Show the first video initially
    showVideo(currentIndex);
  });
  document.addEventListener("DOMContentLoaded", function () {
  // Get all links in the sub-menu
  const submenuLinks = document.querySelectorAll(".sub-menu a");

  submenuLinks.forEach((link) => {
    // Add click event listener to each link
    link.addEventListener("click", function (event) {
      // Remove 'active' class from all sub-menu links
      submenuLinks.forEach((lnk) => lnk.classList.remove("active"));

      // Add 'active' class to the clicked link
      link.classList.add("active");
    });

    // Check if the link's href matches the current URL
    if (link.href === window.location.href) {
      // Add 'active' class to the matching link
      link.classList.add("active");
    }
  });
});
  document.addEventListener("DOMContentLoaded", function () {
  // After 3 seconds, start fading out the fullscreen SVG
  setTimeout(function() {
    const svgElement = document.getElementById('fullscreen-svg');
    if (svgElement) {
      svgElement.style.opacity = '0';

      // After transition is complete (1s), remove the element from the DOM
      setTimeout(function() {
        svgElement.parentNode.removeChild(svgElement);
      }, 1000);
    }
  }, 3000);
});
</script>
